===============================================================================
【タイトル】 comeconv
【ファイル】 comeconv.exe
【作成月日】 2021/09/29
【著 作 者】 nnn-revo2012
【開発環境】 Microsoft Windows 10
             Microsoft Visual Studio Community 2017
【動作環境】 Microsoft Windows 10 / Windows 8.1 / Windows 7
             .NET Framework 4.7.2
【推奨環境】 Microsoft Windows 10
【配布形態】 フリーウェア
【Web Site】 https://github.com/nnn-revo2012/comeconv
【 連絡先 】 要望やバグ報告等はgithubまで
             その他　nnn_revo2012@yahoo.co.jp　
===============================================================================

■説明
・ニコニコ生放送のコメントや動画、Twitchのコメントを変換するツールです。
・GUI(Windows Forms)使用。
・ニコ生新配信録画ツール（仮などでダウンロードした動画やコメントをさきゅばすで合成するための
  各種変換をおこないます
・TwitchDownloaderおよびchat-downloaderでダウンロードしたTwitchのコメントをニコ動形式および
　さきゅばす合成用に変換します。
・そのほかのコメントや動画も行えるようにする予定。

■インストール方法
適当なフォルダにzipファイルの中のファイルを全て解凍してください。解凍したらその中のcomeconv.exe を実行してください。
※ダウンロード時や実行時にウイルスやマルウェアの警告が出る可能性があります。
  当方でウイルスチェックは行っております。あらかじめご了承ください。

■アンインストール方法
アンインストールの際は comeconv.exe の入っているフォルダごと削除してください。

■動画変換の手順
　変換の全体的な手順は以下を参照ください。本ツールは NicomentXenoglossia で手作業で行ってる部分を
ドラッグ＆ドロップだけで処理できることを目標に作成しております。

【2019年版】うんこちゃん生放送録画・投稿 まとめ
https://ch.nicovideo.jp/nekton/blomaga/ar1716253

■使用方法
1.comeconv.exeを起動する。
2.さきゅばす変換タブが表示されます。
　初期値では絵文字は空白、流量調整コメ（うすい文字）は通常文字として表示、ギフトとエモーションは画面下に
　固定表示されます。
3.運営コメやNGワードにしたいコメントはNGワードの「編集」ボタンをクリックしてメモ帳で追加してください。
4.動画変換はニコ生新配信録画ツール(仮 などで録画した場合の .tsファイルをさきゅばすで扱えるように
　変換するものです(FFmpegでtsファイルからmp4/flvに変換してるだけです)。
5.真中の右側の「Save」ボタンを押すと設定が保存されます。
6.画面の緑色の部分に動画ファイルやコメントファイルをドラッグ＆ドロップすると変換されます。

★生主が自分の放送をアップロードするための手順
1.タイムシフト視聴ページからダウンロードページを開いて映像データーをダウンロードしてください。
https://blog.nicovideo.jp/niconews/127212.html
2.コメントを「ニコ生新配信録画ツール(仮」または「NCV」「やります！アンコちゃん」などを使ってダウンロードしてください。
　・ニコ生新配信録画ツール(仮 のツール→オプション→録画方法の「動画データーを取得しない」をクリックすると、コメントだけ取得できます。
　・NCVでは設定→オプション→「コメントログを自動保存する」をチェックするか、ファイル→名前を付けて保存で番組毎にコメントを保存してください。
　・やります！アンコちゃんではファイル→XMLファイルを保存で番組毎にコメントを保存してください。
3.ここで動画ファイルとコメントファイルのファイル名を同じにしておいてください。
4.commeonやこめたんぷれいやのような動画とコメントを同時再生するツールで再生して、コメントが動画とタイミングあってるか確認してください。
　数秒早かったり遅かったりすることがあると思いますが、その場合の秒数をメモなり覚えといてください。
5.本ツール(comeconv.exe)を起動します。通常の場合は初期設定のままで大丈夫だと思います。
　4.でコメントがずれてる秒数を補正します。コメントが遅れてて早めるには -4.00 のようにマイナスをつけて秒数指定してください。
　コメントが早い場合は 6.25 のように秒数を指定してください。
6.NGワード右の「編集」でNGワードが追加できます。
7.変換したいコメントファイルをツールの緑色の部分にドラッグ＆ドロップしてください。
　コメント変換終了しました。　と表示されればOKです。
8.タイムシフト視聴ページからダウンロードした映像データーはflv/mp4のどちらかなのでこのツールで変換する必要はありません。
9.念のためcommeonやこめたんぷれいやのような動画とコメントを同時再生するツールで再生して、コメントが動画とタイミングあってるか確認してください。
　タイミングがずれている、いらないコメントがあるなどの場合は5.に戻ってやりなおしてください。
　やり直す際はまず変換したファイル *.xml を先に消してから *.xml.org を *.xml に名前変更するとスムーズにできます。
10.問題なければさきゅばすで変換してください。

★Twitchのコメント変換
現在対応してるのは以下です
1)TwitchDownloader *1 の Simple Text形式(UTCおよびRelative)、JSON形式 *2
2)chat-downloader の *.json/*.jsonl形式
*1 コメント数が多い(数万件以上)の場合ダウンロード毎にコメ数が１０件ぐらい前後するようです(調査中)
*2 コメント数が多いとメモリーを500～1GBくらい消費します。

■動作環境
.Net Framework 4.7.2以降が必要です。Windows 10では標準でインストールされているので新たにインストールする必要はありません。
https://support.microsoft.com/ja-jp/topic/windows-%E7%94%A8%E3%81%AE-microsoft-net-framework-4-7-2-web-%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%A9%E3%83%BC-dda5cddc-b85e-545d-8d4a-d213349b7775

■動作確認ソフト
・Saccubus（さきゅばす）1.67.2.11
https://github.com/Saccubus/Saccubus1.x/releases
・動画ファイルおよびコメントファイル
  - ニコ生新配信録画ツール（仮
  - livedl
  - NCV (コメントファイルのみ)
  ※ニコニコ動画の動画ファイル、コメントファイルは未検証です
・TwitchDownloader
https://github.com/lay295/TwitchDownloader/releases
・chat-downloader
https://github.com/xenova/chat-downloader/releases

■免責事項
本ソフトウェアを利用して発生した如何なる損害について著作者は一切の責任を負いません。
また著作者はバージョンアップ、不具合修正の義務を負いません。

■ライセンス関係
・comeconv
https://github.com/nnn-revo2012/comeconv
Copyright (c) 2021 nnn-revo2012
Released under the MIT License

・Json.NET
https://www.newtonsoft.com/json
Copyright (c) 2007 James Newton-King
Released under the MIT License

・FFmpeg
https://www.ffmpeg.org/
https://github.com/FFmpeg/FFmpeg/
Copyright (c) 2000-2021 the FFmpeg developers
GNU General Public License v3.0

■更新履歴
2021/06/25　Version 0.0.1.07
　初期バージョンリリース
2021/07/17　Version 0.0.1.08t
　Twitch変換を追加
　その他いろいろな修正
2021/07/20　Version 0.0.1.09
　Twitch変換(TwitchDownloaderのJSON形式)を追加
　チェックボックスなどにツールチップ(ヘルプ表示)追加
　エモーション　ひまわり絵文字を変換
　クルーズコメントを下に小文字表示するように修正
　ギフト、広告、クルーズも絵文字変換するように修正
2021/09/29　Version 0.0.1.10
　Twitch変換
　・chat-downloader最新版(2021/7～)のファイル形式に対応
    json/jsonl形式
